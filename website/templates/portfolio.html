{% extends "base.html" %}
{% block title %}Portfolio{% endblock %}

{% block content %}
<!DOCTYPE html>
<html>
    <head>
        <style>

            .wrapper {
                padding: 20px;
            }

            .positive:before { content: "+"; color: 
            green; }
                    .positive { color: 
            green; }
                    .negative { color: 
            red; }

            .tableFixHead {
                overflow-y: auto;
                height: 200px;
            }

            .tableFixHead thead th {
                position: sticky;
                text-align: center;
                top: 0;
            }
            
            .table {
                width: 100%;
                border-collapse: collapse;
            }

            .table th {
                background-color: rgb(25, 0, 250);
                color: white;
            }

            .table thead tr th {
                font-size: 16px;
                font-weight: 600;
                letter-spacing: .35px;
                color: white;
                opacity: 1;
                padding: 12px;
                vertical-align: top;
                border: 1px solid black;
            }

            .table tbody tr td {
                font-size: 14px;
                letter-spacing: .35px;
                font-weight: normal;
                background-color: white;
                padding: 8px;
                text-align: center;
                border: 1px solid #dee2e685;

            }

            @media (max-width: 768px) {

                .positive:before { content: "+"; color: 
                green; }
                        .positive { color: 
                green; }
                        .negative { color: 
                red; }
                
                .table th {
                    display: none;
                }

                .table, .table tbody, .table tr, .table td {
                    display: block;
                    width: 100%;
                }

                .table tr {
                    margin-bottom: 15px;
                }
                
                .table tbody tr td {
                    text-align: right;
                    padding-left: 50%;
                    position: relative;
                }

                .table td::before {
                    content: attr(data-label);
                    position: absolute;
                    left: 0;
                    width: 50%;
                    padding-left: 15px;
                    font-weight: bold;
                    font-size: 14px;
                    text-align: left;
                }
            }
        </style>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
    </head>
    <body>
        <center>
            {% with messages = get_flashed_messages(with_categories=true) %} {% if
                messages %} {% for category, message in messages %} {% if category ==
                'e' %}
                <div id="alertdanger" role="alert">
                  {{ message }}
                </div>
                {% else %}
                <div id="alertsuccess" role="alert">
                  {{ message }}
                </div>
            {% endif %} {% endfor %} {% endif %} {% endwith %}
        </center>
        <div class="wrapper">
            <h2>Portfolio Manager</h2>
            <form method="post" action="/addportfolio">
                <section>
                    <label>Stocks</label>
                    <select name="search_filter" id="search_filter" class="select">
                        <option value="">-Select Stocks-</option>';
                        {% for row in symbol %}
                            <option value="{{row["symbol"]}}">{{row["symbol"]}}</option>
                        {% endfor %}
                    </select>
                    <input type="hidden" name="symbol" id="hidden_value" required/>
                </section>
                <label>Quantity</label>
                <input id="quantity" type="number" name="quantity" required>
                <label>Initial Value</label>
                <input id="initial_value" type="float" name="initial_value" required>
                <button type="submit">add</button>
            </form>
            <div class="center">
                <div class="table-container">
                    <table id="portfolio" class="table">
                        <thead>
                            <tr>
                                <th>Stock</th>
                                <th>Quantity</th>
                                <th>Initial Value</th>
                                <th>Current Price</th>
                                <th>Total cost</th>
                                <th>Current value</th>
                                <th>PnL</th>
                                <th>PnL (%)</th>
                            </tr>
                        </thead>
                        <tbody>
                            {% for row in portfolio %}
                            <tr>
                                <td data-label="Stock">{{row["symbol"]}}
                                    <a href="{{url_for('auth.editportfolio',id=row['id'])}}" id="e"><i class='bx bxs-edit'></i></a>
                                    <a href="{{url_for('auth.deleteportfolio',id=row['id'])}}" id="d"><i class='bx bxs-trash' ></i></a>
                                </td>
                                <td data-label="Quantity">{{row["quantity"]}}</td>
                                <td data-label="InitialValue">{{row["initial_Value"]}}</td>
                                <td colspan="8"><b>Calculating </b><img src="../static/loading.gif" style="height:10px;"></td>
                            <tr>
                            {% endfor %}
                            <tr>
                                <th>Total</th>
                                <th>&nbsp</th>
                                <th>&nbsp</th>
                                <th>&nbsp</th>
                                <th>&nbsp</th>
                                <th>&nbsp</th>
                                <th>&nbsp</th>
                                <th>&nbsp</th>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </body>
    <script>
        document.getElementById("alertdanger").style.color = "red";
    </script>
    <script>
        document.getElementById("alertsuccess").style.color = "green";
    </script>
    <script type="text/javascript" src="../static/js/portfolio.js" ></script>
</html>
{% endblock %}